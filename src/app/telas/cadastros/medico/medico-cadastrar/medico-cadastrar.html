<form #formCadastro="ngForm" (ngSubmit)="onSubmit()">
  <div class="row g-3">
    <div class="col-12 col-md-6">
      <label for="nome" class="form-label">Nome</label>
      <div class="input-group">
        <span class="input-group-text"><i class="bi bi-person"></i></span>
        <input
          type="text"
          class="form-control"
          id="nome"
          name="nome"
          placeholder="Nome completo"
          [(ngModel)]="medico.nome" 
          required
        />
      </div>
    </div>

    <div class="col-12 col-md-6">
      <label for="crm" class="form-label">CRM</label>
      <div class="input-group">
        <span class="input-group-text"><i class="bi bi-credit-card"></i></span>
        <input
          type="text"
          class="form-control"
          id="crm"
          name="crm"
          placeholder="Ex: CRM 123456"
          [(ngModel)]="medico.crm"
          required
        />
      </div>
    </div>

    <div class="col-12 col-md-6">
      <label for="especialidade" class="form-label">Especialidade</label>
      <div class="input-group">
        <span class="input-group-text"><i class="bi bi-heart-pulse"></i></span>
        <select
          id="especialidade"
          name="especialidade"
          class="form-select custom-select"
          [(ngModel)]="medico.especialidade"
          required
        >
          <!-- MUDANÇA: [ngValue]="null" para funcionar com a inicialização -->
          <option [ngValue]="null" disabled>Selecione uma especialidade</option>
          <option
            *ngFor="let e of listaEspecialidades"
            [ngValue]="e.especialidade" 
          >
            {{ e.especialidade }}
          </option>
        </select>
      </div>
    </div>

    <!-- Email -->
    <div class="col-12 col-md-6">
      <label for="email" class="form-label">Email</label>
      <div class="input-group">
        <span class="input-group-text"><i class="bi bi-envelope"></i></span>
         <!-- MUDANÇA: [(ngModel)]="medico.email" -->
        <input
          type="email"
          class="form-control"
          id="email"
          name="email"
          placeholder="exemplo@email.com"
          [(ngModel)]="medico.email"
          required
        />
      </div>
    </div>

    <!-- Telefone -->
    <div class="col-12 col-md-6">
      <label for="telefone" class="form-label">Telefone</label>
      <div class="input-group">
        <span class="input-group-text"><i class="bi bi-telephone"></i></span>
         <!-- MUDANÇA: [(ngModel)]="medico.telefone" -->
        <input
          type="text"
          class="form-control"
          id="telefone"
          mask="(00) 00000-0000"
          [dropSpecialCharacters]="false"
          autocomplete="off" 
          name="telefone"
          placeholder="(00) 00000-0000"
          [(ngModel)]="medico.telefone"
          required
        />
      </div>
    </div>
  </div>

  <hr class="my-4" />
<div class="scrollable-div">
  <!-- Adicionar Horários (Esta parte já estava correta) -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h5 class="mb-0">Horários de Atendimento</h5>
    <button
      type="button"
      class="btn btn-outline-primary btn-sm"
      (click)="adicionarHorario()"
    >
      <i class="bi bi-plus-lg me-1"></i> Adicionar Horário
    </button>
  </div>

  <!-- Lista de Horários (Esta parte já estava correta) -->
  <div *ngIf="medico.horarios && medico.horarios.length > 0; else semHorarios">
    <div
      *ngFor="let horario of medico.horarios; let i = index"
      class="row g-3 align-items-end mb-3 p-2 border rounded"
    >
      <!-- ... (Campos de horário já usavam 'horario.diaSemana', etc. Está correto) ... -->
      
        <!-- Dia da Semana --> 
      <div class="col-md-4">
        <label class="form-label">Dia da Semana</label>
        <select
          class="form-select custom-select"
          [(ngModel)]="horario.diaSemana"
          name="diaSemana{{ i }}"
          required
        >
          <option value="">Selecione...</option>
          <option *ngFor="let dia of diasSemana" [value]="dia">
            {{ dia }}
          </option>
        </select>
      </div>

      <!-- Hora de Início -->
      <div class="col-md-3">
        <label class="form-label">Início</label>
        <input
          type="time"
          class="form-control"
          [(ngModel)]="horario.horaInicio"
          name="horaInicio{{ i }}"
          required
        />
      </div>

      <!-- Hora de Fim -->
      <div class="col-md-3">
        <label class="form-label">Fim</label>
        <input
          type="time"
          class="form-control"
          [(ngModel)]="horario.horaFim"
          name="horaFim{{ i }}"
          required
        />
      </div>

      <!-- Botão Remover -->
      <div class="col-md-2 text-end">
        <button
          type="button"
          class="btn btn-outline-danger btn-sm"
          (click)="removerHorario(i)"
        >
          <i class="fa-solid fa-trash"></i>
        </button>
      </div>
    </div>
  </div>

  <ng-template #semHorarios>
    <p class="text-muted">Nenhum horário adicionado.</p>
  </ng-template>
</div>
  <hr class="my-4" />

  <!-- Botão de Cadastro -->
  <div class="d-flex justify-content-end">
    <button
      type="submit"
      class="btn btn-success px-4"
      [disabled]="!formCadastro.valid"
    >
      <!-- MUDANÇA: Use medico.id para verificar se é edição -->
      {{ medico.id ? 'Salvar Alterações' : 'Cadastrar Médico' }}
    </button>
  </div>
</form>